---
// server
import Profile from "../../components/Alias";
import Layout from "../../layouts/Layout.astro";
import prisma from "../../lib/prisma";
const { alias } = Astro.params;
let you;

if (alias) {
  try {
    const temp = await prisma.alias.findFirst({
      where: {
        externalId: alias,
      },
      include: {
        teams: true,
      },
    });
    if (temp) {
      you = temp;
      Astro.cookies.set("session", you.externalId, {
        path: "/",
      });
    }
  } catch {
    console.log("not an alias");
  }
}

export const prerender = false;
---

<Layout>
  <Profile alias={you} client:load />
</Layout>
